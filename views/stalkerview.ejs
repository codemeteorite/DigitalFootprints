<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= result[0].username %> ‚Äî Profile</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Tailwind Dark Mode Config -->
  <script>
    tailwind.config = { darkMode: "class" };
  </script>

  <!-- Default theme = Dark -->
  <script>
    if (!localStorage.theme) localStorage.theme = "dark";
    if (localStorage.theme === "dark") {
      document.documentElement.classList.add("dark");
    }
  </script>
</head>

<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen p-4">

  <!-- THEME BUTTON -->
  <button id="themeToggle"
    class="fixed top-4 right-4 z-50 p-3 rounded-full bg-white dark:bg-gray-800 shadow text-xl hover:scale-110 transition">
    ‚òÄÔ∏è
  </button>

  <!-- BACK BUTTON -->
  <a href="/feed"
    class="fixed top-4 left-4 z-50 bg-indigo-600 text-white px-4 py-2 rounded-lg shadow hover:bg-indigo-700 transition">
    ‚¨Ö Enough Stalking?
  </a>

  <!-- MAIN WRAPPER -->
  <div class="max-w-7xl mx-auto pt-20">

    <div class="bg-gray-200 dark:bg-gray-800 shadow-xl rounded-2xl p-6 flex flex-col lg:flex-row gap-10">

      <!-- LEFT BIG PHOTO (FREE SIZE) -->
      <div class="w-full lg:w-[40%] flex justify-center">
        <% if (result[0].profile_photo_url) { %>
          <img
            src="<%= result[0].profile_photo_url %>"
            class="w-full max-h-80 object-contain rounded-xl shadow-md"
          />
        <% } else { %>
          <div
            class="w-full h-96 bg-gray-300 dark:bg-gray-700 flex items-center justify-center text-gray-700 dark:text-gray-300 rounded-xl">
            No Photo Uploaded
          </div>
        <% } %>
      </div>

      <!-- RIGHT INFO -->
      <div class="w-full lg:w-[60%] space-y-4">
        <h2 class="text-4xl font-bold">@<%= result[0].username %></h2>

        <p class="text-gray-700 dark:text-gray-300 text-lg"><%= result[0].email %></p>

        <% if (result[0].dream) { %>
          <p class="text-lg">
            <span class="font-bold">Dream:</span>
            <span class="font-semibold"><%= result[0].dream %></span>
          </p>
        <% } else { %>
          <p class="text-lg text-gray-400 italic">No dream added yet.</p>
        <% } %>

        <p class="opacity-70">
          Joined:
          <% if (result[0].created_at instanceof Date) { %>
            <%= result[0].created_at.toDateString() %>
          <% } else { %>
            <%= new Date(result[0].created_at).toDateString() %>
          <% } %>
        </p>
      </div>

    </div>

    <!-- POSTS SECTION -->
    <h3 class="text-2xl font-bold text-pink-400 mt-10 mb-4">Their Digital Fossils</h3>

    <div class="space-y-4">

      <% const hasPosts = result.some(r => r.post); %>

      <% if (!hasPosts) { %>

        <div class="bg-gray-200 dark:bg-gray-800 p-6 rounded-xl text-center text-gray-600 dark:text-gray-300">
          No posts yet.
        </div>

      <% } else { %>

        <% result.forEach(p => { if (p.post) { %>

          <div class="bg-gray-200 dark:bg-gray-800 p-5 rounded-xl shadow">
            <p class="text-lg mb-2"><%= p.post %></p>

            <p class="text-sm opacity-70">
              <% if (p.post_time instanceof Date) { %>
                <%= p.post_time.toLocaleString() %>
              <% } else { %>
                <%= new Date(p.post_time).toLocaleString() %>
              <% } %>
            </p>
          </div>

        <% } }); %>

      <% } %>

    </div>

  </div>

  <!-- DARK MODE SCRIPT -->
  <script>
    const toggle = document.getElementById("themeToggle");

    function updateIcon() {
      toggle.textContent =
        document.documentElement.classList.contains("dark") ? "‚òÄÔ∏è" : "üåô";
    }

    toggle.addEventListener("click", () => {
      const isDark = document.documentElement.classList.toggle("dark");
      localStorage.theme = isDark ? "dark" : "light";
      updateIcon();
    });

    updateIcon();
  </script>

</body>

</html>
